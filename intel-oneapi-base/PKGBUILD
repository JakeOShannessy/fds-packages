# Maintainer: Your Name <youremail@domain.com>
pkgname=intel-oneapi-base
pkgver=2021.3.0
pkgrel=1
epoch=
pkgdesc="IntelÂ® oneAPI Base Toolkit."
arch=('x86_64')
url="https://software.intel.com"
license=('AllRightsReserved')
groups=()
depends=()
makedepends=()
checkdepends=()
optdepends=()
provides=()
conflicts=()
replaces=()
backup=()
options=(!strip)
install=
changelog=
source=("https://registrationcenter-download.intel.com/akdlm/irc_nas/17977/l_BaseKit_p_2021.3.0.3219_offline.sh")
noextract=()
sha1sums=('0f10bdeb66f44301af4eb10dcc94b19fbbb32c65')
validpgpkeys=()

prepare() {
        chmod 755 "$srcdir/l_BaseKit_p_2021.3.0.3219_offline.sh"
        # rm -f "$srcdir/FDS6.7.6_SMV6.7.16_rls_lnx.tar.gz"
        # echo "extract" | "$srcdir/FDS6.7.6_SMV6.7.16_rls_lnx.sh"
}

build() {
        echo "done"
}

check() {
        echo "done"
}

package() {
        echo ${pkgdir}/opt/intel
        "$srcdir/l_BaseKit_p_2021.3.0.3219_offline.sh" -s -a --silent  --eula accept --install-dir ${pkgdir}/opt/intel --intel-sw-improvement-program-consent decline --components intel.oneapi.lin.ippcp.devel:intel.oneapi.lin.tbb.devel:intel.oneapi.lin.dpcpp_dbg:intel.oneapi.lin.dpcpp-ct:intel.oneapi.lin.dpcpp-cpp-compiler:intel.oneapi.lin.dnnl:intel.oneapi.lin.mkl.devel:intel.oneapi.lin.ipp.devel:intel.oneapi.lin.python3:intel.oneapi.lin.ccl.devel:intel.oneapi.lin.dpl:intel.oneapi.lin.vtune
        # FINAL_INSTALL_DIR=/opt/FDS/$pkgver+nist.ifort
        # INSTALLDIR=$pkgdir$FINAL_INSTALL_DIR
        # mkdir -p $INSTALLDIR
        # tar -xzvf FDS6.7.6_SMV6.7.16_rls_lnx.tar.gz --directory $INSTALLDIR
        # mv ${INSTALLDIR}/bin/fds ${INSTALLDIR}/bin/fds-exec
        # echo "#!/bin/sh" > ${INSTALLDIR}/setup.sh
        # echo "impihome=${FINAL_INSTALL_DIR}/bin/INTEL" >> ${INSTALLDIR}/setup.sh
        # echo "export FI_PROVIDER_PATH=\$impihome/prov" >> ${INSTALLDIR}/setup.sh
        # echo "export I_MPI_ROOT=\$impihome/mpi" >> ${INSTALLDIR}/setup.sh
        # echo "export LD_LIBRARY_PATH=\$impihome/lib:\$LD_LIBRARY_PATH" >> ${INSTALLDIR}/setup.sh
        # echo "export MKLROOT=\$impihome/mkl" >> ${INSTALLDIR}/setup.sh
        # echo "export PATH=\$impihome/bin:\$PATH" >> ${INSTALLDIR}/setup.sh
        # echo "#!/bin/sh" > ${INSTALLDIR}/bin/fds
        # echo "source ${FINAL_INSTALL_DIR}/setup.sh" >> ${INSTALLDIR}/bin/fds
        # echo "ulimit -s unlimited" >> ${INSTALLDIR}/bin/fds
        # echo "ulimit -s unlimited" >> ${INSTALLDIR}/bin/fds
        # echo "ulimit -s unlimited" >> ${INSTALLDIR}/bin/fds
        # echo "exec ${FINAL_INSTALL_DIR}/bin/INTEL/bin/mpiexec -np \$1 ${FINAL_INSTALL_DIR}/bin/fds-exec \"\${@:2}\"" >> ${INSTALLDIR}/bin/fds
        # chmod 755 ${INSTALLDIR}/setup.sh
        # chmod 755 ${INSTALLDIR}/bin/fds
        # chown root:root $pkgdir -R
        echo "done"
}
